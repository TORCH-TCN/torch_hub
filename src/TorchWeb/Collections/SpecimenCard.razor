<figure class="specimen-card">
    <img src="@ImageUrl" alt="@Specimen.Catalog_number" />
    <figcaption>
        <h2>@Specimen.Catalog_number</h2>
        <aside>
            @Status
        </aside>
    </figcaption>
</figure>

@inject IConfiguration Config
@code {
    [Parameter] public SpecimenResponse Specimen { get; set; } = null!;
    [CascadingParameter] public SocketIOClient.SocketIO Socket { get; set; }
    SpecimenResponse LocalSpecimen;
    string? Status;

    protected override async Task OnInitializedAsync()
    {
        LocalSpecimen = Specimen;
        Socket.On($"specimen_updated_{Specimen.Id}", (response) =>
        {
            LocalSpecimen.Catalog_number = response.GetValue<string>(0);
            Status = response.GetValue<string>(1);
            StateHasChanged();
        });
    }

    string? ImageUrl => (Specimen.Card_image?.External_url?.StartsWith("http") == true ? "" : Config["Blossom:Authority"])
        + Specimen.Card_image?.External_url;
}
